{% load static %}

<a href="{% url 'product_list_by_region' region_slug=product.region.slug %}">
    ← Back to {{ product.region.name }} Products
</a>

<div class="product-info-grid">
    <div class="image-gallery">
        {% for image in images %}
            {% if image.is_main %}
                <img src="{{ image.media_file.url }}" alt="{{ product.name }}" style="max-width: 400px;">
            {% endif %}
        {% endfor %}
    </div>

    <div class="details">
        <h1>{{ product.name }}</h1>
        <p class="price">Price: ₹{{ product.price|floatformat:2 }}</p>

        <h3>Product Details</h3>
        <p>{{ product.description|linebreaksbr }}</p>

        {% if product.stock_quantity > 0 %}
            <form method="post" action="{% url 'add_to_cart' product_pk=product.pk %}">
                {% csrf_token %}
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" value="1" min="1" max="{{ product.stock_quantity }}">
                <button type="submit">Add to Cart</button>
            </form>
        {% else %}
            <p class="out-of-stock">Out of Stock</p>
        {% endif %}

        <hr>

        {% if product.artisan %}
            <h2>The Artisan's Tale: {{ product.artisan.display_name }}</h2>
            {% if product.artisan.profile_image %}
                <img src="{{ product.artisan.profile_image.url }}" alt="{{ product.artisan.display_name }}" style="max-width: 100px; border-radius: 50%;">
            {% endif %}
            <p>{{ product.artisan.bio_story|linebreaksbr }}</p>
            <small>Origin: {{ product.region.name }}</small>
        {% endif %}
    </div>
</div>